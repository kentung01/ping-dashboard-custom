import{d as z,J as F,i,k as R,K as G,C as H,x as u,L as J,r as K,o as p,l as f,n as t,z as x,w as U,v as Q,t as d,q as h,M as W,m as k,I as V,A as X,F as Y,p as Z,O as ee,P as te}from"./index-b40d15d5.js";import{_ as se}from"./DonutChart.vue_vue_type_script_setup_true_lang-59d43dd9.js";import{A as ae}from"./vue3-apexcharts.common-89b24fde.js";import{g as ne}from"./apexChartConfig-a2312667.js";const oe={class:"overflow-x-auto w-full rounded-md"},le={class:"flex flex-wrap justify-between bg-base-100 p-5"},ce={class:"min-w-0"},re=t("h2",{class:"text-2xl font-bold leading-7 sm:!truncate sm:!text-3xl sm:!tracking-tight"}," Portfolio ",-1),ie={class:"flex items-center text-sm"},ue=t("option",null,"usd",-1),de=t("option",null,"cny",-1),he=t("option",null,"eur",-1),_e=t("option",null,"hkd",-1),ve=t("option",null,"jpy",-1),me=t("option",null,"sgd",-1),pe=t("option",null,"krw",-1),fe=t("option",null,"btc",-1),ge=t("option",null,"eth",-1),be=[ue,de,he,_e,ve,me,pe,fe,ge],ke={class:"text-right"},ye=t("div",null,"Total Value",-1),we={class:"text-success font-bold"},Ce={class:"bg-base-100"},je={key:0,class:"grid grid-cols-1 md:grid-cols-3"},xe={class:"md:col-span-2"},De={class:"overflow-x-auto mt-4"},Ne={class:"table w-full"},Ee=t("thead",{class:"bg-base-200"},[t("tr",null,[t("th",null,"Token"),t("th",{class:"text-right"},"Value"),t("th",{class:"text-right"},"Percent")])],-1),Oe={class:"flex gap-1 text-xs items-center"},Se={class:"avatar"},Ie={class:"mask mask-squircle w-6 h-6 mr-2"},qe=["src","alt"],Ae={class:"uppercase font-bold text-lg"},Be={class:"capitalize"},Ve={class:"text-right"},$e={class:"text-right"},Te={key:1,class:"p-4 text-center"},Le={class:"text-center my-5 bg-base-200"},Ge=z({__name:"portfolio",setup(Me){const c=F(),$=i(JSON.parse(localStorage.getItem("imported-addresses")||"{}")),T=R(),D=i({}),N=i({}),g=i({}),E=i(!1),m=i(localStorage.getItem("currency")||"usd"),b=i([]),y=i(0),O=i(0);G(()=>{y.value>0&&y.value===O.value&&(E.value||(E.value=!0,I()))}),Object.values($.value).forEach(a=>{a&&a.forEach(e=>{if(e.endpoint&&e.address){y.value+=1;const n=T.randomEndpoint(e.chainName),s=H.newDefault((n==null?void 0:n.address)||e.endpoint);s.getBankBalances(e.address).then(o=>{const l=o.balances.filter(r=>r.denom.length<10);l&&(D.value[e.address||""]=l),l.forEach(r=>{g.value[r.denom]=e})}).finally(()=>{O.value+=1}),s.getStakingDelegations(e.address).then(o=>{o&&o.delegation_responses&&(N.value[e.address||""]=o.delegation_responses),o.delegation_responses.forEach(l=>{g.value[l.balance.denom]=e})})}})});const _=u(()=>{const a={};return Object.values(D.value).forEach(e=>{e.forEach(n=>{var o;const s=c.tokenDisplayNumber(n);s&&(a[n.denom]?a[n.denom].qty+=s:a[n.denom]={qty:s,coinId:((o=c.findGlobalAssetConfig(n.denom))==null?void 0:o.coingecko_id)||""})})}),Object.values(N.value).forEach(e=>{e.forEach(n=>{var o;const s=c.tokenDisplayNumber(n.balance);s&&(a[n.balance.denom]?a[n.balance.denom].qty+=s:a[n.balance.denom]={qty:s,coinId:((o=c.findGlobalAssetConfig(n.balance.denom))==null?void 0:o.coingecko_id)||""})})}),a}),v=u(()=>{const a={};return Object.keys(_.value).forEach(e=>{const n=_.value[e],s=b.value.find(o=>o.id===n.coinId);a[e]=s?n.qty*s.current_price:0}),a}),S=u(()=>Object.values(v.value).reduce((a,e)=>a+e,0)),w=u(()=>{const a=[];return Object.keys(v.value).map(e=>{var n,s;a.push({denom:e,value:v.value[e],chainName:(n=g.value[e])==null?void 0:n.chainName,logo:(s=g.value[e])==null?void 0:s.logo,percentage:v.value[e]/S.value})}),a.filter(e=>e.value>0).sort((e,n)=>n.value-e.value)});function I(){localStorage.setItem("currency",m.value);const a=Object.values(_.value).map(e=>e.coinId).join(",");te(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=${m.value}&ids=${a}&order=market_cap_desc&per_page=100&page=1&sparkline=true&price_change_percentage=14d&locale=en`).then(e=>{b.value=e})}const C=u(()=>Object.values(_.value).map(a=>{const e=b.value.find(n=>n.id===a.coinId);return e?a.qty*(e.price_change_24h||0):0}).reduce((a,e)=>a+e,0)),L=u(()=>{var s,o;const a=Object.keys(_.value).map(l=>{var B;const r=_.value[l],A=b.value.find(j=>j.id===r.coinId);return A?(B=A.sparkline_in_7d)==null?void 0:B.price.map(j=>j*r.qty):[]}).filter(l=>l.length>0),e=((s=a.at(0))==null?void 0:s.length)||0,n=new Array(e).fill(0);for(let l=0;l<e;l++)for(let r=0;r<a.length;r++)n[l]+=((o=a.at(r))==null?void 0:o.at(l))||0;return[{name:"value",data:n}]}),M=J(),P=u(()=>{const a=M.theme,e=[],n=new Date().getTime();for(let s=0;s<168;s++)e.unshift(n-s*2*60*60*1e3);return ne(a,e)}),q=u(()=>{switch(m.value){case"usd":return"$";case"cny":return"¥";case"eur":return"€";case"hkd":return"HK$";case"jpy":return"¥";case"sdg":return"S$";case"krw":return"₩";case"btc":return"BTC";case"eth":return"ETH"}return"$"});return(a,e)=>{const n=K("RouterLink");return p(),f("div",oe,[t("div",le,[t("div",ce,[re,t("div",null,[t("div",ie,[x(" Currency: "),U(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),onChange:I,class:"ml-1 uppercase"},be,544),[[Q,m.value]])])])]),t("div",ke,[ye,t("div",we,d(q.value)+" "+d(h(c).formatNumber(S.value,"0,0.[00]")),1),t("div",{class:W(["text-xs",{"text-success":C.value>0,"text-error":C.value<0}])},d(h(c).formatNumber(C.value,"+0,0.[00]")),3)])]),t("div",Ce,[w.value?(p(),f("div",je,[t("div",null,[k(se,{height:"280",series:Object.values(v.value),labels:Object.keys(v.value).map(s=>{var o;return(o=h(c).tokenDisplayDenom(s))==null?void 0:o.toUpperCase()})},null,8,["series","labels"])]),t("div",xe,[k(h(ae),{type:"area",height:"280",options:P.value,series:L.value},null,8,["options","series"])])])):V("",!0),t("div",De,[k(X,{class:"bg-base-200",id:"portfolio-banner-ad",unit:"banner",width:"970px",height:"90px"}),t("table",Ne,[Ee,t("tbody",null,[(p(!0),f(Y,null,Z(w.value,(s,o)=>(p(),f("tr",{key:o},[t("td",null,[t("div",Oe,[t("div",Se,[t("div",Ie,[t("img",{src:s.logo,alt:s.chainName},null,8,qe)])]),t("span",Ae,d(h(c).tokenDisplayDenom(s.denom)),1),x(" @ "),t("span",Be,d(s.chainName),1)])]),t("td",Ve,d(q.value)+d(h(c).formatNumber(s.value,"0,0.[00]")),1),t("td",$e,d(h(c).percent(s.percentage)),1)]))),128))])])]),w.value.length===0?(p(),f("div",Te," No Data ")):V("",!0)]),t("div",Le,[k(n,{to:"./accounts",class:"btn btn-link"},{default:ee(()=>[x("Add More Asset")]),_:1})])])}}});export{Ge as default};
